<h1>New Ship</h1>


<form role="form" action="#" id="form">
	<div class="form-group">		 
		<label for="origem">
			Origem
		</label>
		<select id="origem">
		  <option value="">Selecione</option>
		</select>
	</div>
	<div class="form-group">		 
		<label for="origem">
			Destino
		</label>
		<select id="destino">
		  <option value="">Selecione</option>
		</select>
	</div>
	<div class="form-group">		 
		<label for="peso">
			Peso
		</label>
		<input type="text" class="form-control" id="peso" />
	</div>
	<button id="calcular" class="btn btn-primary">
		Calcular
	</button>
</form>
<div id="calculo"></div>
<%= link_to 'Voltar', ships_path %>

<script type="text/javascript">
$( document ).ready(function() { 
	$.ajax({
        url: 'http://localhost:3005/api/v1/distancias.json',
        type: 'get',
        success: function(data){
            $.each(data, function(id, obj){
                var option = new Option(obj.origem, obj.origem);
                var optionDestino = new Option(obj.destino, obj.destino);
                $(option).html(obj.origem);
                $(optionDestino).html(obj.destino);
                $("#destino").append(optionDestino);
                $("#origem").append(option);
            });
        }
    });
});
$("#calcular").click(function(){
  var origem = document.getElementById("origem").value;
  var destino = document.getElementById("destino").value;
  var weight = document.getElementById("peso").value;
  $.ajax({
   url : "http://localhost:3006/costs",
   type : 'get',
   data : {
            origem,
            destino,
            weight
           },
    success: function (data) {
    		$("p").remove();
    		var resultado = $("<p></p>").text("O valor do frete Ã© $"+data); 
            $("#calculo").append(resultado);
        }            
	});
});
</script>

